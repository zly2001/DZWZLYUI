<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="../css/index.css" />
		<style type="text/css">
			.el-row {
				margin-bottom: 20px;
				&:last-child {
					margin-bottom: 0;
				}
			}
			
			.el-col {
				border-radius: 4px;
			}
			
			.bg-purple-dark {
				background: #99a9bf;
			}
			
			.bg-purple {
				background: #d3dce6;
			}
			
			.bg-purple-light {
				background: #e5e9f2;
			}
			
			.grid-content {
				border-radius: 4px;
				min-height: 36px;
			}
			
			.row-bg {
				padding: 10px 0;
				background-color: #f9fafc;
			}
			
			#biao {
				font-size: 30px;
				color: red;
				font-weight: bold;
			}
			.d{
				margin-left: 260px;
			}
		</style>
	</head>
	<body>
		<div id="tong">
			<el-row>
				<el-col :span="4" :offset="2">
					<span id="biao">通讯名录</span>
				</el-col>
				<el-col :span="2" :offset="14">
					<el-button type="primary" plain @click="updateEmployeeInfo">保存</el-button>
					
				</el-col>
				<el-col :span="2">
  					<div>
  						<el-button type="info" plain>关闭</el-button>
  					</div>
  				</el-col>
			</el-row>
			
			<el-table class="tb-edit" :data="EmployeeData" style="width: 100%" @row-click="getDetails" highlight-current-row @current-change="handleCurrentChange">
				<el-table-column prop="dename" label="部门名称" >
				</el-table-column>
				<el-table-column prop="employeeid" label="员工工号" >
				</el-table-column>
				<el-table-column prop="ename" label="员工姓名" >
				</el-table-column>
				<!--<el-table-column prop="id" label="部门">
					<template slot-scope="scope">
						<el-input size="small" v-model="scope.row.id" placeholder="请输入内容" @change="handleEdit(scope.$index, scope.row)"></el-input>
						<span>{{scope.row.id}}</span>
					</template>
				</el-table-column>
				<el-table-column prop="id" label="员工工号">
					<template slot-scope="scope">
						<el-input size="small" v-model="scope.row.id" placeholder="请输入内容" @change="handleEdit(scope.$index, scope.row)"></el-input>
						<span>{{scope.row.id}}</span>
					</template>
				</el-table-column>
				<el-table-column prop="id" label="员工姓名">
					<template slot-scope="scope">
						<el-input size="small" v-model="scope.row.id" placeholder="请输入内容" @change="handleEdit(scope.$index, scope.row)"></el-input>
						<span>{{scope.row.id}}</span>
					</template>
				</el-table-column>-->
				<el-table-column prop="ephone" label="电话">
					<template slot-scope="scope">
						<el-input size="small" v-model="scope.row.ephone" placeholder="请输入内容" @change="handleEdit(scope.$index, scope.row)"></el-input>
						
					</template>
				</el-table-column>
				<el-table-column prop="phone1" label="分机">
					<template slot-scope="scope">
						<el-input size="small" v-model="scope.row.phone1" placeholder="请输入内容" @change="handleEdit(scope.$index, scope.row)"></el-input>
					</template>
				</el-table-column>
				<el-table-column prop="email" label="邮箱">
					<template slot-scope="scope">
						<el-input size="small" v-model="scope.row.email" placeholder="请输入内容" @change="handleEdit(scope.$index, scope.row)"></el-input>
					</template>
				</el-table-column>
			</el-table>
			
			
			
			
			
			<el-table :data="tableData" style="width: 100%">
            <el-table-column prop="id" label="工号">
              <template slot-scope="scope">
                <el-input
                  size="small"
                  v-model="scope.row.id"
                  v-show="scope.row.showEdit"
                  placeholder="请输入内容"
                ></el-input>
                <span v-show="!scope.row.showEdit">{{scope.row.id}}</span>
              </template>
            </el-table-column>
            <el-table-column prop="name" label="姓名">
              <template slot-scope="scope">
                <el-input
                  size="small"
                  v-model="scope.row.name"
                  v-show="scope.row.showEdit"
                  placeholder="请输入内容"
                ></el-input>
                <span v-show="!scope.row.showEdit">{{scope.row.name}}</span>
              </template>
            </el-table-column>
            <el-table-column prop="age" label="年龄">
              <template slot-scope="scope">
                <el-input
                  size="small"
                  v-model="scope.row.age"
                  v-show="scope.row.showEdit"
                  placeholder="请输入内容"
                ></el-input>
                <span v-show="!scope.row.showEdit">{{scope.row.age}}</span>
              </template>
            </el-table-column>
            <el-table-column prop="score" label="分数">
              <template slot-scope="scope">
                <el-input
                  size="small"
                  v-model="scope.row.score"
                  v-show="scope.row.showEdit"
                  placeholder="请输入内容"
                ></el-input>
                <span v-show="!scope.row.showEdit">{{scope.row.score}}</span>
              </template>
            </el-table-column>
            <el-table-column label="操作">
              <template slot-scope="scope">
                <el-button
                  size="small"
                  class="btn bg_green"
                  @click="handleEdit(scope.$index, scope.row)"
                >{{scope.row.showEdit?'保存':"修改"}}</el-button>
              </template>
            </el-table-column>
</el-table>
			
		</div>
	</body>
	<script type="text/javascript" src="../js/jquery-1.12.4.js" ></script>
	<script type="text/javascript" src="../js/vue.js"></script>
	<script type="text/javascript" src="../js/axios.min.js"></script>
	<script type="text/javascript" src="../js/axios_cfg.js"></script>
	<script type="text/javascript" src="../js/index.js"></script>
	<script>
		var tong = new Vue({
			el:"#tong",
			data:{
				EmployeeData: [{}],
				updateEmployee:{},
				Rows:{},
				
				 tableData:[
	    {
	      id: '10001',
	      name: '张三',
	      age: '26',
	      score: '90',
	      showEdit: false
	    },
		{
	      id: '10002',
	      name: '李四',
	      age: '27',
	      score: '95',
	      showEdit: false
	    },
		{
	      id: '10003',
	      name: '王五',
	      age: '26',
	      score: '98',
	      showEdit: false
	    }], 
			
			
			
			},
			mounted() {
				alert('我是茶王');
				this.load();
			},
			methods: {
				 handleEdit(index, row) {
      				//console.log(index, row);
      				//console.log(this.EmployeeData);
    			},
    			handleCurrentChange(row, event, column) {
      				//console.log(row, event, column);
    			},
    			getDetails(row){
    				alert('我是茶王');
    				let _this = this;
    				_this.Rows = row;
					axios.get("http://127.0.0.1:8080/DZWWeb/qj/api/QjEmployeeAction/selectEmployee/"+row.employeeid).then(function(resp) {
						_this.updateEmployee = resp.data;
						//console.log(_this.LizhiEmployeeData);
					}).catch(function(e) {
						console.info(e);
					});
    			},
      			load(){
      				let _this = this;
      				axios.get("http://127.0.0.1:8080/DZWWeb/qj/api/QjEmployeeAction/queryOnline").then(function(resp) {
						_this.EmployeeData = resp.data;
						console.log(_this.EmployeeData);
					}).catch(function(e) {
						console.info(e);
					});
      			},
      			updateEmployeeInfo(){
					let _this = this;
      				console.log(_this.Rows);
      				
					_this.updateEmployee.ephone = _this.Rows.ephone;
					_this.updateEmployee.phone1 = _this.Rows.phone1;
					_this.updateEmployee.email =  _this.Rows.email;
      				axios.put("http://127.0.0.1:8080/DZWWeb/qj/api/QjEmployeeAction/updateEmployee",this.updateEmployee).then(function(resp){
						if(resp.data.code=="200"){
							_this.$message({
         						message: '修改成功',
          						type: 'success'
        						});
        						_this.load();
						}
					}).catch(function(e){
						console.log(e);
					});
				},
				
				
				
				
				handleEdit(index, row) {
      console.log(index, row);
      row.showEdit = !row.showEdit;
      if (!row.showEdit) {
        console.log("提交");
        console.log(row);
       }
    }
				
				
      		},
		})
	</script>
</html>
