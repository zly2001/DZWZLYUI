<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		
	</head>

	<body>
		<div id="app">
			<h2>品牌车型</h2>
			<el-row :gutter="20">
				<el-col :span="12">
					车辆品牌名称:&nbsp;
					<el-input v-model="input" style="width:300px" placeholder="请输入内容"></el-input>&nbsp;&nbsp;
					<el-button icon="el-icon-search" circle @click="gotoPage(1)"></el-button>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<el-button type="primary" @click="xzdialogFormVisible = true">新增</el-button>
					<br><br>
					<div class="grid-content bg-purple">
						<template>
							<el-table :data="tableData" style="width:100%" border @row-click="openDetails">
								<el-table-column label="序号" width="50px">
									<template slot-scope="temp">
										{{temp.$index+1}}
									</template>
								</el-table-column>
								<el-table-column prop="brandid" label="车辆品牌编号" width="120px">
								</el-table-column>
								<el-table-column prop="brandname" label="车辆品牌名称" width="250px">
								</el-table-column>
								<el-table-column prop="brandfirstzm" label="首字母" width="70px">
								</el-table-column>
								<el-table-column label="编辑" width="130px">
									<template slot-scope="temp">
										<el-button type="primary" icon="el-icon-edit" circle @click="xgclpp(temp.row.brandid,temp.row.brandname,temp.row.brandfirstzm)"></el-button>
										<el-button type="danger" icon="el-icon-delete" @click="scclpp(temp.$index,temp.row.brandid)" circle></el-button>
									</template>
								</el-table-column>
							</el-table>
						</template>
						<div v-show="info.list!=''" style="text-align: center;">
							<br>
							<el-button type="primary" @click="gotoPage(1)">首页</el-button>
							<el-button type="primary" @click="shangyy(info.prePage)">上一页</el-button>
							<el-button type="primary" @click="xiayy(info.nextPage)">下一页</el-button>
							<el-button type="primary" @click="gotoPage(info.lastPage)">尾页</el-button>

						</div>
					</div>

					<el-dialog title="修改车辆品牌" :visible.sync="xgdialogFormVisible">
						<el-form :model="form">
							<el-form-item label="车辆品牌编号" :label-width="formLabelWidth">
								<el-input v-model="bh" autocomplete="off" :disabled="true"></el-input>
							</el-form-item>
							<el-form-item label="车辆品牌名称" :label-width="formLabelWidth">
								<el-input v-model="name" autocomplete="off"></el-input>
							</el-form-item>
							<el-form-item label="首字母" :label-width="formLabelWidth">
								<el-input v-model="szm" autocomplete="off"></el-input>
							</el-form-item>
						</el-form>
						<div slot="footer" class="dialog-footer">
							<el-button @click="xgdialogFormVisible=false">取 消</el-button>
							<el-button type="primary" @click="xgclpp2()">确 定</el-button>
						</div>
					</el-dialog>

					<el-dialog title="新增车辆" :visible.sync="xzdialogFormVisible">
						<el-form :model="form">
							<el-form-item label="车辆品牌名称" :label-width="formLabelWidth">
								<el-input v-model="xz.brandname" autocomplete="off"></el-input>
							</el-form-item>
							<el-form-item label="首字母" :label-width="formLabelWidth">
								<el-input v-model="xz.brandfirstzm" autocomplete="off"></el-input>
							</el-form-item>
						</el-form>
						<div slot="footer" class="dialog-footer">
							<el-button @click="xzdialogFormVisible=false">取 消</el-button>
							<el-button type="primary" @click="xzclpp()">确 定</el-button>
						</div>
					</el-dialog>

				</el-col>

				<el-col :span="12">
					<!--<div class="grid-content bg-purple">
						车辆品牌名称:&nbsp;
						<el-input v-model="input2" style="width:300px" placeholder="请输入内容"></el-input>&nbsp;&nbsp;
						<el-button icon="el-icon-search" circle @click=""></el-button>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<el-button type="primary" @click="">新增</el-button>
						<br><br>
						<div class="grid-content bg-purple">
							<template>
								<el-table :data="tableData2" style="width:100%" border>
									<el-table-column label="序号" width="50px">
										<template slot-scope="temp">
											{{temp.$index+1}}
										</template>
									</el-table-column>
									<el-table-column prop="" label="车辆品牌编号" width="120px">
									</el-table-column>
									<el-table-column prop="" label="车辆品牌名称" width="250px">
									</el-table-column>
									<el-table-column prop="" label="首字母" width="70px">
									</el-table-column>
									<el-table-column label="编辑" width="130px">
										<template slot-scope="temp">
											<el-button type="primary" icon="el-icon-edit" circle @click=""></el-button>
											<el-button type="danger" icon="el-icon-delete" @click="" circle></el-button>
										</template>
									</el-table-column>
								</el-table>
							</template>
							<div v-show="info2.list!=''" style="text-align: center;">
								<br>
								<el-button type="primary" @click="">首页</el-button>
								<el-button type="primary" @click="shangyy()">上一页</el-button>
								<el-button type="primary" @click="xiayy()">下一页</el-button>
								<el-button type="primary" @click="gotoPage()">尾页</el-button>
							</div>
						</div>
					</div>-->
				</el-col>
			</el-row>

		</div>
	</body>
	
	<script>
		var app = new Vue({
			data: {
				bh: "",
				name: "",
				szm: "",
				xgdialogFormVisible: false,
				xzdialogFormVisible:false,
				input: "",
				input2:"",
				info: [],
				info2: [],
				tableData: [],
				tableData2:[],
				xz: {
					brandid: 0,
					brandname: "",
					brandfirstzm: "",
					column1: "",
					column2: null,
					column3: null,
					column4: null
				}
			},
			methods: {
				gotoPage(page) {
					let _this = this;
					var name = _this.input == "" ? "-1" : _this.input;
					axios.get(`http://127.0.0.1:8080/DZWWeb//lp/api/Engine/selectAll2/${page}/${name}`).then(function(resp) {
						_this.tableData = resp.data.list;
						_this.info = resp.data;
						
					}).catch(function(e) {
						console.info(e);
					});
				},
				/*gotoPage2(page,index){
					let _this = this;
					var name = _this.input2 == "" ? "-1" : _this.input2;
					var index2 = index == "" ? "-1" : index;
					axios.get(`http://127.0.0.1:8080/DZWWeb//lp/api/Engine/selectAll3/${page}/${name}/${index2}`).then(function(resp) {
						_this.tableData2 = resp.data.list;
						_this.info2 = resp.data;
					}).catch(function(e) {
						console.info(e);
					});
				},*/
				xgclpp(bh, name, szm) {
					let _this = this;
					_this.xgdialogFormVisible = true;
					_this.bh = bh;
					_this.name = name;
					_this.szm = szm;
				},
				xgclpp2() {
					let _this = this;
					axios.get(`http://127.0.0.1:8080/DZWWeb//lp/api/Engine/updataMotorcycle/${_this.bh}/${_this.name}/${_this.szm}`).then(function(resp) {
						_this.gotoPage(1);
						_this.xgdialogFormVisible = false;

					}).catch(function(e) {
						console.info(e);
					});
					this.$message({
						type: 'success',
						message: '修改成功！!',
					});
				},
				scclpp(index,bh) {

					this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {
						confirmButtonText: '确定',
						cancelButtonText: '取消',
						type: 'warning'
					}).then(() => {
						axios.get(`http://127.0.0.1:8080/DZWWeb//lp/api/Engine/removeMotorcycle/${bh}`).then(function(resp) {
							_this.gotoPage(1);
						}).catch(function(e) {
							console.info(e);
						});
						this.tableData.splice(index, 1);
						this.$message({
							type: 'success',
							message: '删除成功!',
						});
					}).catch(() => {
						this.$message({
							type: 'info',
							message: '已取消删除'
						});
					});
				},
				openDetails(row) {
					_this.gotoPage2(page,row.brandid);
				},
				xzclpp(){
					let _this = this;

					if(_this.xz.brandfirstzm==""||_this.xz.brandname==""){
						this.$message({
							type: 'info',
							message: '请填写完整信息！'
						});
					}
					else{
						axios.post(`http://127.0.0.1:8080/DZWWeb/lp/api/Engine/addMotorcycle/`,_this.xz).then(function(resp) {
							_this.gotoPage(1);
							_this.xz.brandname="";
							_this.xz.brandfirstzm="";
					}).catch(function(e) {
						console.info(e);
					});
				
					_this.xzdialogFormVisible=false;
					
					this.$message({
						type: 'success',
						message: '新增成功!',
						
					});
					}
					
				}

			},

			mounted() {
				let _this = this;
				this.gotoPage(1);
			//	this.gotoPage2(1,"");
			//	this.gotoPage2(1,_this.tableData[0].brandid);
			}
		}).$mount("#app")
	</script>

</html>