<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		
	</head>

	<body>
		<div id="app">
			<h2>供货商</h2> 供货商名称:&nbsp;
			<el-input v-model="input" style="width:200px" placeholder="请输入内容"></el-input>&nbsp;&nbsp;&nbsp;
			<el-button icon="el-icon-search" circle @click="gotoPage(1)"></el-button>
			&nbsp;&nbsp;
			<el-button type="primary" @click="dialogFormVisible = true">新增</el-button>
			<el-dialog title="新增供货商" :visible.sync="dialogFormVisible">
				<el-form :model="firm">
					<el-form-item label="发动机品牌名称" :label-width="formLabelWidth">
						<el-input v-model="firm.firmname" autocomplete="off"></el-input>
					</el-form-item>
					<el-form-item label="发动机品牌名称" :label-width="formLabelWidth">
						<el-input v-model="firm.faddress" autocomplete="off"></el-input>
					</el-form-item>
					<el-form-item label="发动机品牌名称" :label-width="formLabelWidth">
						<el-input v-model="firm.fphone" autocomplete="off"></el-input>
					</el-form-item>
					<el-form-item label="发动机品牌名称" :label-width="formLabelWidth">
						<el-input v-model="firm.lxr" autocomplete="off"></el-input>
					</el-form-item>
					<el-form-item label="发动机品牌名称" :label-width="formLabelWidth">
						<el-input v-model="firm.lphone" autocomplete="off"></el-input>
					</el-form-item>
				</el-form>
				<div slot="footer" class="dialog-footer">
					<el-button @click="dialogFormVisible=false">取 消</el-button>
					<el-button type="primary" @click="xzFrim()">确 定</el-button>
				</div>
			</el-dialog>
			
			
			<el-dialog title="修改供货商" :visible.sync="dialogFormVisible2">
				<el-form :model="firm">
					<el-form-item label="发动机品牌名称" :label-width="formLabelWidth">
						<el-input v-model="firm.firmname" autocomplete="off"></el-input>
					</el-form-item>
					<el-form-item label="发动机品牌名称" :label-width="formLabelWidth">
						<el-input v-model="firm.faddress" autocomplete="off"></el-input>
					</el-form-item>
					<el-form-item label="发动机品牌名称" :label-width="formLabelWidth">
						<el-input v-model="firm.fphone" autocomplete="off"></el-input>
					</el-form-item>
					<el-form-item label="发动机品牌名称" :label-width="formLabelWidth">
						<el-input v-model="firm.lxr" autocomplete="off"></el-input>
					</el-form-item>
					<el-form-item label="发动机品牌名称" :label-width="formLabelWidth">
						<el-input v-model="firm.lphone" autocomplete="off"></el-input>
					</el-form-item>
				</el-form>
				<div slot="footer" class="dialog-footer">
					<el-button @click="dialogFormVisible2=false">取 消</el-button>
					<el-button type="primary" @click="xgFirm2()">确 定</el-button>
				</div>
			</el-dialog>

			<br /><br />
			<template>
				<el-table :data="tableData" style="width:100%" border>
					<el-table-column label="序号" width="50px">
						<template slot-scope="temp">
							{{temp.$index+1}}
						</template>
					</el-table-column>
					<el-table-column prop="firmname" label="供货商名称" width="100px">
					</el-table-column>
					<el-table-column prop="faddress" label="供货商地址" width="200px">
					</el-table-column>
					<el-table-column prop="fphone" label="公司地址" width="200px">
					</el-table-column>
					<el-table-column prop="lxr" label="联系人" width="100px">
					</el-table-column>
					<el-table-column prop="lphone" label="联系人电话" width="150px">
					</el-table-column>
					<el-table-column label="编辑" width="130px">
						<template slot-scope="temp">
							<el-button type="primary" icon="el-icon-edit" circle @click="xgFirm(temp.row)"></el-button>
							<el-button type="danger" icon="el-icon-delete" @click="delRow(temp.$index,temp.row.firmid)" circle></el-button>
						</template>
					</el-table-column>
				</el-table>
			</template>
			<footer v-show="info.list!=''" style="text-align: center;">
				<br>
				<el-button type="primary" @click="gotoPage(1)">首页</el-button>
				<el-button type="primary" @click="shangyy(info.prePage)">上一页</el-button>
				<el-button type="primary" @click="xiayy(info.nextPage)">下一页</el-button>
				<el-button type="primary" @click="gotoPage(info.lastPage)">尾页</el-button>
			</footer>
		</div>
	</body>
	
	
	<script type="text/javascript">
		var app = new Vue({
			data: {
				bh: "",
				name: "",
				info: [],
				input: "",
				dialogFormVisible: false,
				dialogFormVisible2: false,
				tableData: [],
				formLabelWidth: '120px',
				firm:{
					firmid:0,
					firmname:"",
					faddress:"",
					fphone:"",
					lxr:"",
					lphone:"",
					fsevenst:null,
					column1:null,
					column2:null,
					column3:null,
					column4:null
				},
			},
			methods: {
				gotoPage(page) {
					let _this = this;
					var bh = _this.input == "" ? "-1" : _this.input;
					axios.get(`http://127.0.0.1:8080/DZWWeb//lp/api/Engine/selectAll3/${page}/${bh}`).then(function(resp) {
						_this.tableData = resp.data.list;
						_this.info = resp.data;

					}).catch(function(e) {
						console.info(e);
					});
				},
				xzFrim() {
					let _this = this;
					axios.post(`http://127.0.0.1:8080/DZWWeb//lp/api/Engine/addFirm`,_this.firm).then(function(resp) {
						_this.gotoPage(1);
					}).catch(function(e) {
						console.info(e);
					});
					this.$message({
						type: 'success',
						message: '新增成功!',
					});
					_this.dialogFormVisible = false;
				},
				xgFirm(row) {
					let _this = this;
					_this.firm.firmid=row.firmid;
					_this.firm.firmname=row.firmname;
					_this.firm.faddress=row.faddress;
					_this.firm.fphone=row.fphone;
					_this.firm.lxr=row.lxr;
					_this.firm.lphone=row.lphone;
					_this.dialogFormVisible2 = true;
				},
				xgFirm2() {
					let _this = this;
						axios.put(`http://127.0.0.1:8080/DZWWeb//lp/api/Engine/updateFirm`,_this.firm).then(function(resp) {
							_this.gotoPage(1);
						}).catch(function(e) {
							console.info(e);
						});
						this.$message({
							type: 'success',
							message: '修改成功!',
						});
						_this.dialogFormVisible2 = false;
					

				},
				delRow(index, bh) {
					this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {
						confirmButtonText: '确定',
						cancelButtonText: '取消',
						type: 'warning'
					}).then(() => {
						axios.get(`http://127.0.0.1:8080/DZWWeb//lp/api/Engine/removeFirm/${bh}`).then(function(resp) {
							this.gotoPage(1);
						}).catch(function(e) {
							console.info(e);
						});
						this.tableData.splice(index, 1);
						this.$message({
							type: 'success',
							message: '删除成功!',
						});
					}).catch(() => {
						this.$message({
							type: 'info',
							message: '已取消删除'
						});
					});
				},

				shangyy(page) {
					let _this = this;
					if(_this.info.hasPreviousPage == false) {
						this.$message({
							message: '当前是第一页哦',
							type: 'warning'
						});
					} else {
						this.gotoPage(page);
					}
				},
				xiayy(page) {
					let _this = this;
					if(_this.info.hasNextPage == false) {
						this.$message({
							message: '当前是最后一页哦',
							type: 'warning'
						});
					} else {
						this.gotoPage(page);
					}
				}

			},
			mounted() {
				this.gotoPage(1);
			}
		}).$mount("#app")
	</script>

</html>